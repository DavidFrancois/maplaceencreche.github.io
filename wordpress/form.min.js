"use strict";jQuery(document).ready(function(){function e(){$("#main-submit > span").html(c),$("#main-submit").attr("disabled",!1)}var a="DD/MM/YYYY",i={previousMonth:"Mois précédent",nextMonth:"Mois suivant",months:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],weekdays:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],weekdaysShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"]};$(".mpec-date").each(function(e,n){new Pikaday({field:n,firstDay:1,format:a,i18n:i})});var n=$('select[name="children_number"]');n.change(function(){if(""!==n.val())for(var e=1;e<=n.val();e++)$("#child"+e).fadeIn(),$("#child"+e+" input").prop("required",!0),$("#child"+(e+1)+", #child"+(e+2)).fadeOut(),$("#child"+(e+1)+" input, #child"+(e+2)+" input").prop("required",!1);else $("#child1, #child2, #child3").fadeOut()});var r=$("#zip"),t=$("#city");if(r.autocomplete({source:function(e,a){$.ajax({url:"https://icare.maplaceencreche.com/api/static/zipcode/"+e.term,dataType:"json",success:function(e){a($.map(e,function(e){return e.z+", "+e.c}))}})},select:function(e,a){t.val(a.item.value.substring(7))},minLength:3}),r.focusout(function(){var e=$(this).val();$(this).val(e.slice(0,5)),t.css({borderColor:""})}),r.change(function(){r.val().length<4&&t.val("")}),null!==localStorage.getItem("MPECData")){var o=JSON.parse(localStorage.getItem("MPECData")).meta;for(var s in o){var u=o[s];$("#meta-inputs").append('<input type="hidden" name="meta_'+s+'" value="'+u+'">')}}$('input[readonly], input[name="you_earning"]').change(function(){$(this).css({borderColor:""})});var c=$("#main-submit > span").html();$("form#family-register").submit(function(a){a.preventDefault();var i=!0;$("#main-submit").attr("disabled",!0),$("#main-submit > span").html("Inscription en cours ..."),$(".error-block").html(""),""===$("input[readonly]").val()&&($("input[readonly]").each(function(e){""===$(this,e).val()&&$(this,e).css({borderColor:"#d9534f"})}),$(".error-block").append("<p>Vous avez des champs obligatoires non remplis.</p>"),i=!1),(isNaN(parseInt($('input[name="you_earning"]').val()))||parseInt($('input[name="you_earning"]').val())<1)&&($('input[name="you_earning"]').css({borderColor:"#d9534f"}),$(".error-block").append("<p>Vous avez saisi une valeur de revenus non valide.</p>"),i=!1),i?$.ajax({url:"https://icare.maplaceencreche.com/api/input/register",type:"post",dataType:"json",data:$(this).serialize(),success:function(e){window.location.href="/merci-famille"},error:function(a){$(".error-block").html("Une erreur est survenue lors de l'envoi du formulaire, veuillez réessayer."),e()}}):e()})});